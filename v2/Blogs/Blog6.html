<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>David Shonack - CloudFlare</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/bulma@1.0.2/css/bulma.min.css">
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.9.0/dist/gsap.min.js"></script>
    <style>
        body {
          font-family: 'Open Sans', sans-serif;
        }
        .social-icons a {
          margin: 0 10px;
          transition: color 0.3s ease;
        }
        .social-icons a:hover {
          color: #f5f5f5;
        }
        .button.is-link {
          transition: background-color 0.3s ease;
        }
        .button.is-link:hover {
          background-color: #2366d1;
        }
        .animated-underline {
          position: relative;
          display: inline-block;
        }
        .animated-underline::after {
          content: '';
          position: absolute;
          width: 0;
          height: 2px;
          bottom: 0;
          left: 0;
          background-color: #3273dc;
          transition: width 0.3s ease;
        }
        .animated-underline:hover::after {
          width: 100%;
        }
        .blog-content {
          line-height: 1.8;
          color: #f5f5f5; /* Light gray for main text */
        }
        .blog-content p {
          margin-bottom: 1.5rem;
        }
        .blog-content h2 {
          margin-top: 2rem;
          margin-bottom: 1rem;
          color: rgb(51, 153, 255) !important; /* Already a light color */
        }
        .blog-content h3 {
          /* Let's make these a bit lighter */
          color: #ddd !important; /* A slightly lighter gray */
          margin-top: 1.5rem;
          margin-bottom: 1rem;
        }
        .blog-image {
          border-radius: 8px;
          box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
          transition: transform 0.3s ease;
          max-width: 100%;
          height: auto;
          margin: 1rem 0;
        }
        .blog-image:hover {
          transform: scale(1.02);
        }
        .author-box {
          border-radius: 8px;
          transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .author-box:hover {
          transform: translateY(-5px);
          box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        .related-post {
          transition: transform 0.3s ease;
        }
        .related-post:hover {
          transform: translateY(-5px);
        }
        .tag {
          transition: background-color 0.3s ease;
        }
        .tag:hover {
          background-color: #3273dc;
          color: white;
        }
        code {
          background-color: #f5f5f5;
          color: #ff3860;
          padding: 0.2em 0.4em;
          border-radius: 3px;
          font-size: 0.9em;
        }
        .content img {
          max-width: 100%;
          height: auto;
          margin: 1rem 0;
          border-radius: 8px;
        }
        strong {
          /* Let's make these white or a very light gray */
          color: white !important;
        }
      </style>
  </head>
  <body>
    <!-- Navigation bar -->
    <div id="navbar-container"></div>

    <!-- Load the include script -->
    <script src="./navbarBlogs.js" defer></script>

    <!-- Hero Section -->
    <section class="hero is-link is-medium">
      <div class="hero-body">
        <div class="container has-text-centered">
          <p class="title is-2">
            How CloudFlare acts as a Shield for Malicous Websites
          </p>
          <p class="subtitle">
          </p>
          <div class="mt-4">
            <span class="tag  mr-2">Privacy</span>
            <span class="tag  mr-2">Security</span>
            <span class="tag ">Web</span>
          </div>
          <p class="mt-4 is-size-6">
            Published on May 30, 2025 by <strong>David Thomas Shonack</strong>
          </p>
        </div>
      </div>
    </section>

    <!-- Social Media Banner -->
    <div class="box has-background-black has-text-white">
      <p class="has-text-centered">
        <span class="tag is-primary">New</span> Feel free to drop in and check out my socials! I'd love to get to know you guys and connect!
      </p>
      <div class="has-text-centered mt-3 social-icons">
        <a href="https://www.linkedin.com/in/david-shonack-29a7a4250" target="_blank" class="icon is-large has-text-white mx-2" aria-label="LinkedIn">
          <i class="fab fa-linkedin fa-2x"></i>
        </a>
        <a href="https://github.com/spinklerz" target="_blank" class="icon is-large has-text-white mx-2" aria-label="GitHub">
          <i class="fab fa-github fa-2x"></i>
        </a>
        <a href="mailto:dshonack@ucsc.edu" class="icon is-large has-text-white mx-2" aria-label="Email">
          <i class="fas fa-envelope fa-2x"></i>
        </a>
      </div>
    </div>
    
    <!-- Blog Content -->
    <section class="section">
      <div class="container">
        <div class="columns is-centered">
          <!-- Main Content -->
          <div class="column is-8 is-flex is-justify-content-center is-flex-direction-column">        
            
            <!-- Blog Text -->
            <div class="content blog-content">
              <h1 id="introduction" style="color:rgb(51, 153, 255)">Introduction</h1>
              <p>CloudFlare is an industry leader in providing high quailty security , content delivery, and performance optimizations. For legitmate web services and websites, it does a very good job, and even offers free tier security making deployment simple and seemless. This blog isnt to bash Cloudflare but to bring to attention the role it has when malicous actors use Cloudflare to hide its infrastructure. </p>
              <h2>Investigation</h2>
              <p>Friday morning I got up from bed and the first thing I see is an imessage saying the following: 
    <pre>
    California State Department of Motor Vehicles (DMV) Final Notice: Enforcement Penalties Begin on May 31.
    Our records show that as of today, you still have an outstanding traffic ticket. In accordance with California State Administrative Code 15C-16.003, if you do not complete payment by May 31, 2025, we will take the following actions:
    
    1. Report to the DMV violation database
    2. Suspend your vehicle registration starting May 31
    3. Suspend driving privileges for 30 days
    4. Transfer to a toll booth and charge a 35% service fee
    5. You may be prosecuted and your credit score will be affected
    Pay Now:https://example_malicous_site.com
    
    
    Please pay immediately before enforcement to avoid license suspension and further legal disputes.
    (Reply Y and re-open this message to click the link, or copy it to your browser.)</pre></p>
    <p>I read this and I thought man I would not only have my vechile registration suspeneded by but also my driving privelages. Not to mention the fact my credit score will be affected and ill have to pay a 35% fee. I started to think what kind of cruel world we live in, when I was reminded that I did not own a car. In all seriousness I love getting these types of messages because it opens the door for investigatoins! I fired up kali linux and burp and dove right in.</p>
    <h2>Analysis</h2>
        <p>First thing I did was run curl to see what im dealing with <code>curl -vv example_malicous_site.com</code>. And I recieved a 404. I've noticed a trend with phishing campaigns and its that they target specfic user agents like moblie users. So I looked up valid user agents for moblie iphones and ran the curl again. <code>curl -vv -A "Mozilla/5.0 (iPhone; CPU iPhone OS 18_3_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.3 Mobile/15E148 Safari/604.1" example_malicous_site.com</code> And I got results! Now intially it looked like California DMV's website with a little form that would prompt you to put in information like your name, email, and address things like that. And when I filled it out with sample responses the connection hung. Now I don't know if there was an error on my part, i was walking through the site connection by connection and I did not see a POST with this form data and I did not track it via web network inspector. What I did notice is that there endpoints like <code>/front/init?token=jwt_token</code> and <code>/front/any</code> which is what was being posted. It seemed like the user was being activley fingerprinted. What i did notice is I managed to find an insecure endpoint which I believe was the <code>/front/config</code> page that gave me a bit more insight on what was going on.</p>
        <img src="../images/threat_hunt.png" alt="Threat Hunt" class="image is-4by3">
        <p>Theres a couple of interesting things that standout first off the cloudflare is being annoying, but if we look at the response we get some more info on what im guessing is the communication between the web server and the c2. I also noticed a success, 200 and another success message. Before I try to put everything together let me give you another piece of important context, check this request out. <pre>Dfxd2ytJZhHeN2H/XuZWIdx4VzpYoFq19XdDX4H7wXkUWuJWfJq57rIU6eGj3PLM4nU3FW2RRf6BdaguBLEercXlpPNZgCz40VphpFKPIx2ATDz7OfzgWWiU04XPaNKbfgC1tmIfqLX6G6grYagwVzbZRYCUm4VmA9/StPweKPY/QslPklvAU8BL/RGdkiRdMsZ4HxSr3zOrZ5ib43mzLyLcfvYV91h55Ptlua9v729EfrUNK0omojZCyNPqjQzWdkTrDIoZZ+b0dx1hWjFGYlB8lzzCGqM3SIHR35IflQSKbEoFCz+rbX4c4X9+oEYXEQFtX1S7sqQ/FzLQCCIJ0FDUgbD1vfHj0DyzQAY4GKVjiUOGnOZklRkrXB5IJ4k2TRPfc+Uh9Db669PBxcHNrjP7lej50Aas1YSFDc9Iszr9bfZ+Ho7Pg2GVXiRTWidaaZznPRW3YEHOJ2HEhI58ujo=</pre>While I dont have the full GET and POST requests, encrypted or encoded data was being sent from my machine to the malicous site. So a POST would have encoded data like that, weirdly enough even GET request, it would persist without a content length or paramter the payload would still appear under the headers. Gathering everything heres what I think was happening: </p>
        <ul>
            <li>First the front/init?token=jwt_tokwn was attempting to fingerprint users and would assign them a cookie</li>
            <li>Next the user would traverse the page and constantly send POSTS to front/any</li>
            <li>The local js files were encrypting the payload and the data being sent to front/any</li>
            <li>Taking a look at the image, we see 3 notifications of success, I believe a 3 stage process is happening</li>
            <ul><li>First when the application recieves the data that is warrented a success or 200</li>
            <li>Next once recieved it is then decoded, and gives a success: true</li>
            <li>Finally the data is sent to the c2 server from the applications web server.</li>
        </ul>
        </ul>
        <p>This left kind of a bitter taste in my mouth since I feel like I was put in a position to do something good but I just couldn't take the next step. And I also wish I could've saved the js scripts to peek at how they encrypted the data. So what does this have to do with CloudFlare? </p>
        <h2>CloudFlare</h2>
        <p>CloudFlare did an awesome job of hiding the attackers web server ip. On whois the domain was created the day of and resolved to 4 ipv4's and 4 ipv6's with if I remember cloudflare nameservers. Which is already fun but what really made me confused as to why there report abuse page makes it mandatory to notify the host of the website? Check it out: </p>
   <img src="../images/CloudFlare.png" alt="CloudFlare Abuse Report" class="image is-4by3">
   <p>While I understand that CloudFlare does not have the ability to take down domains, its response time is abismal. Many hours after the websites interface was or shutdown by some law enforcement CloudFlare was still serving the domain. Now I dont know too much about CloudFlare and maybe the domain was still cached but why is it so easy for attackers to hide themselves behide reputable sources, and why is it so difficult to strip websites of this shielding? Cloudflare made this invesitgation many times more difficult. </p>
   <p><ul>
    <li>Just a Pipe - Cloudflare is just a pipe and is not responsile as to what flows through it</li>
    <li>Section 230 - Protects these companies from any sort of prosecution due to them not being liable to the content being produced under "free speech"</li>
   </ul> </p><p>Similar to how banks are being held liable for money landering, so does these companies. The data that passes through them is significant. </p>

   <h2>Conclusion</h2>
   <p>CloudFlare is huge and scalable providing many benifits to website hosts and its users. But when something becomes to easy to access other will begin to abuse it. We need to hold these companies accountable, they are far from pipes. In my case Cloudflare was the middleman in protecting this malicous attacker syphioning money away from innocent people. With the power this infrastrcure has it needs to be more regulated. </p>
            <!-- Tags -->
            <div class="tags mt-5">
              <span class="tag is-medium">Privacy</span>
              <span class="tag is-medium">Security</span>
              <span class="tag is-medium">Web</span>
              <span class="tag is-medium">Exploitation</span>
            </div>
            
            <!-- Author Box -->
            <div class="box author-box has-background-light mt-6">
              <article class="media">
                <div class="media-left">
                  <figure class="image is-96x96">
                    <img class="is-rounded" src="/api/placeholder/192/192" alt="Author profile picture">
                  </figure>
                </div>
                <div class="media-content">
                  <div class="content">
                    <p>
                      <strong class="is-size-4">David Thomas Shonack</strong> <small class="is-size-6 has-text-grey">@dweebus</small>
                      <br>
                      Computer science student and privacy advocate based in California. Interested in security, software development, digital rights, and much more.
                    </p>
                    <div class="buttons mt-2">
                      <a href="https://github.com/spinklerz" class="button is-small is-link is-outlined">
                        <span class="icon">
                          <i class="fab fa-github"></i>
                        </span>
                        <span>GitHub</span>
                      </a>
                      <a href="mailto:dshonack@ucsc.edu" class="button is-small is-link is-outlined">
                        <span class="icon">
                          <i class="fas fa-envelope"></i>
                        </span>
                        <span>Email</span>
                      </a>
                    </div>
                  </div>
                </div>
              </article>
            </div>
            </div>
          
          <!-- Sidebar -->
            
          
    
    <!-- Footer Section -->
    
    <!-- Simple JS for modals and animations -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // Enable any modals if needed
        document.querySelectorAll('.modal-button').forEach(function(el) {
          el.addEventListener('click', function() {
            const target = document.querySelector(this.getAttribute('data-target'));
            target.classList.add('is-active');
          });
        });
        
        document.querySelectorAll('.modal-close, .modal-background').forEach(function(el) {
          el.addEventListener('click', function() {
            this.closest('.modal').classList.remove('is-active');
          });
        });
        
        gsap.fromTo(".hero .title", { opacity: 0, y: -40 }, { opacity: 1, y: 0, duration: 1.5, ease: "power2.out" });
        gsap.from(".hero .subtitle", { opacity: 0, y: 20, duration: 1, ease: "power2.out", delay: 0.3 });
        gsap.from(".blog-content", { opacity: 0, y: 20, duration: 1, ease: "power2.out", delay: 0.5 });
        gsap.from(".blog-content img", { opacity: 0, y: 20, duration: 1, stagger: 0.3, ease: "power2.out", delay: 0.8 });
        gsap.from(".tags", { opacity: 0, y: 10, duration: 0.8, ease: "power2.out", delay: 1 });
        gsap.from(".author-box", { opacity: 0, y: 20, duration: 0.8, ease: "power2.out", delay: 1.2 });
      });
    </script>
  </body>
</html>